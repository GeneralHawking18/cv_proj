Generating order:sequential
Run type:caption
Namespace(seed=42, batch_size=1, device='cuda', run_type='caption', prompt='Image of', order='sequential', control_type='sentiment', pos_type=[['DET'], ['ADJ', 'NOUN'], ['NOUN'], ['VERB'], ['VERB'], ['ADV'], ['ADP'], ['DET', 'NOUN'], ['NOUN'], ['NOUN', '.'], ['.', 'NOUN'], ['.', 'NOUN']], sentiment_type='positive', samples_num=2, sentence_len=10, candidate_k=200, alpha=0.02, beta=2.0, gamma=5.0, theta=3.0, lm_temperature=0.1, num_iterations=10, lm_model='bert-base-uncased', match_model='openai/clip-vit-base-patch32', caption_img_path='./examples/girl.jpg', stop_words_path='./text_control/gibbs_polish/stop_words.txt', add_extra_stopwords=[], seed_len=3)
iter 1, The 1-th image: G,clip score 0.305: [CLS] a photo of the horse running herd displayed a large animal head. [SEP]
iter 2, The 1-th image: G,clip score 0.286: [CLS] a photo of the horse running away with a huge red horse. [SEP]
iter 3, The 1-th image: G,clip score 0.315: [CLS] a photo of the horse riding scene includes a large runaway horse. [SEP]
iter 4, The 1-th image: G,clip score 0.325: [CLS] a photo of the horse chase background shows a runaway white horse. [SEP]
Finished in 4.952s
The 1-th image: G
final caption: a photo of the horse chase background shows a runaway white horse.
best caption: a photo of the horse chase background shows a runaway white horse.
